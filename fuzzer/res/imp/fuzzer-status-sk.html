<!-- The <fuzzer-status-sk> element displays the status of the fuzzer

  Attributes:
    None

  Events:
    None

  Methods:
    None
-->
<link rel="import" href="/res/imp/bower_components/iron-ajax/iron-ajax.html">
<dom-module id="fuzzer-status-sk">
  <template>
    <span>
      <a href$="{{commitLink}}" target="_blank">Last Commit In Fuzz: {{shortHash}}
      - {{author}}</a>
    </span>
    <iron-ajax auto url="/status" handle-as="json" last-response="{{_status}}"></iron-ajax>
  </template>
  <script>
  Polymer({
    is: "fuzzer-status-sk",

    properties: {
      _status: {
        type: Object,
        value: function() {
          return {
            hash: "Loading",
            author: "loading (Loading)"
          };
        }
      },
      shortHash: {
        type: String,
        computed: "_getShortHash(_status)"
      },
      author: {
        type: String,
        computed: "_getAuthor(_status)"
      },
      commitLink: {
        type: String,
        computed: "_getLink(_status)"
      }
    },

    _getShortHash: function(status) {
      return status.hash.substr(0, 7);
    },

    _getAuthor: function(status) {
      var a = status.author;
      var idx = a.indexOf('(');
      return a.substring(0, (idx === -1) ? a.length : idx);
    },

    _getLink:function(status) {
      return "https://skia.googlesource.com/skia/+/" + status.hash;
    }
  });
  </script>
</dom-module>
