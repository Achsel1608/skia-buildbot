<!-- The <op-sk> custom element declaration.

  Attributes:
    op - A deserialized JSON object that describes the operation.

    Presumes ops are structured as below, where the "details" will
    change based on the name of the opertion.

      {
        command: "line",
        ...,
      }

    selected - True if this op has been selected.

  Events:
    op-toggled - This event is sent when a paper-checkbox is toggled.
        The checked status and index of the op are returned in e.detail.

        {
          checked: false,
          index: 102,
        }

  Methods:
    None.
-->

<link rel=import href="/res/imp/bower_components/paper-checkbox/paper-checkbox.html">
<link rel=import href="/res/common/imp/9/details-summary.html">
<dom-module id="op-sk">
  <style type="text/css" media="screen">
    details-sk {
      display: block;
    }

    details-sk[selected] {
      background: #eee;
    }

    pre {
      margin-left: 3em;
    }

    summary-sk span {
      float: right;
      margin-top: 0.7em;
      margin-right: 1em;
    }
  </style>
  <template>
    <details-sk selected$="{{selected}}">
      <summary-sk id=summary><paper-checkbox id=toggle checked style$="padding-right: {{
          op._depth }}em;" on-tap="_check"></paper-checkbox>{{ op.command }} <span>{{index}}</span></summary-sk>
      <pre>
{{ _display(op) }}
      </pre>
    </details-sk>
  </template>
</dom-module>

<script>
  Polymer({
    is: "op-sk",

    properties: {
      op: {
        type: Object,
        value: function() { return {}; },
        reflectToAttribute: false,
      },
      selected: {
        type: Boolean,
        value: false,
        reflectToAttribute: false,
      },
      index: {
        type: Number,
        value: 0,
        reflectToAttribute: true,
      },
    },

    _display: function(op) {
      return JSON.stringify(op, null, 2);
    },

    _check: function(e) {
      var detail = {
        checked: this.$.toggle.checked,
        index: this.index,
      };
      this.dispatchEvent(new CustomEvent('op-toggled', { detail: detail, bubbles: true }));
      e.stopPropagation();
    },

  });
</script>
