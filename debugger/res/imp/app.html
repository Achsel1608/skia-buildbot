<!-- The <debugger-app-sk> custom element declaration.

The main application element for the Skia Debugger.

  Attributes:
    None.

  Events:
    None.

  Methods:
    None.

-->
<link rel=import href="/res/imp/bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel=import href="/res/imp/bower_components/paper-header-panel/paper-header-panel.html">
<link rel=import href="/res/imp/bower_components/paper-icon-button/paper-icon-button.html">
<link rel=import href="/res/imp/bower_components/paper-toolbar/paper-toolbar.html">
<link rel=import href="/res/imp/bower_components/iron-icons/iron-icons.html">
<link rel=import href="/res/imp/bower_components/iron-icon/iron-icon.html">
<link rel=import href="/res/imp/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel=import href="/res/imp/bower_components/iron-selector/iron-selector.html">

<link rel=import href="/res/common/imp/9/error-toast-sk.html">
<dom-module id="debugger-app-sk">
  <style type="text/css" media="screen">
    :root {
      --paper-toolbar-background: #1f78b4;
    }

    :host {
      display: block;
      height: 100%
    }

    #content {
      margin: 1em;
    }

    op-sk {
      display: block;
    }

    details-sk.iron-selected {
      background: #eee;
    }

    #center {
      margin: 0 10px;
    }

    * {
      font-family: Helvetica,Arial,'Bitstream Vera Sans',sans-serif;
    }

  </style>
  <template>
    <paper-header-panel>
      <paper-toolbar>
        <div>Skia Debugger</div>
      </paper-toolbar>
      <div id=content>
        <div class="layout horizontal">
          <div id=left class="layout vertical flex-1">
            <h2>Ops</h2>
            <iron-selector id=selector>
              <template is="dom-repeat" items="{{json.commands}}" as="command">
                <op-sk op="{{command}}"></op-sk>
              </template>
            </iron-selector>
          </div>
          <div id=center class="layout vertical flex-3">
            <h2>Image</h2>
            <div id=rendered>
              <img id=img src="">
            </div>
          </div>
          <div id=right class="layout vertical flex-1">
            <h2>Controls</h2>
          </div>
        </div>
        <hr/>
        <h2>Upload an SKP here.</h2>
        <form enctype="multipart/form-data" method="post" id=post_skp action="/new" name="fileinfo">
          <label>SKP to send:</label>
          <input type="file" name="file" required />
          <input type="submit" value="Upload" />
        </form>
        <error-toast-sk></error-toast-sk>
      </div>
    </paper-header-panel>
  </template>
</dom-module>

<script>
  Polymer({
    is: "debugger-app-sk",

    ready: function() {
      // Load the test image served by the debugger.
      this.$.img.src = window.location.origin + "/img";
      this.$.post_skp.action= window.location.origin + "/new";

      // Can't set this as an attribute directly on iron-selector. Bah.
      this.$.selector.selectedAttribute = "selected";

      this.json = {
        "version": 1,
        "commands": [
        {
          "command": "Matrix",
          "matrix": [
            [ 1, 0, 20 ],
            [ 0, 1, 20 ],
            [ 0, 0, 1 ]
          ]
        },
        {
          "command": "Path",
          "path": [
          {
            "move": [
              200.103638,
              900.077698
            ]
          },
          {
            "conic": [
              [
                -199.97406,
                600.181335
              ],
              [
                99.922302,
                200.103638
              ],
              0.707107
            ]
          },
          {
            "conic": [
              [
                399.818665,
                -199.97406
              ],
              [
                799.896362,
                99.922302
              ],
              0.707107
            ]
          },
          {
            "conic": [
              [
                1199.974121,
                399.818665
              ],
              [
                900.077698,
                799.896362
              ],
              0.707107
            ]
          },
          {
            "conic": [
              [
                669.959167,
                1106.886719
              ],
              [
                313.870209,
                964.064331
              ],
              0.793353
            ]
          }
          ],
          "paint": {
            "color": [
              255,
              148,
              65,
              165
            ],
            "style": "stroke",
            "strokeWidth": 15,
            "antiAlias": true
          }
        }
        ]
      };
    },
  });
</script>
